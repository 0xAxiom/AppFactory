{
  "meta": {
    "run_id": "factory-094718",
    "idea_id": "kids_timer_004",
    "idea_name": "VisualBell",
    "idea_dir": "03_visualbell__kids_timer_004",
    "source_root": "/Users/melted/Documents/GitHub/app factory/the_factory/runs/2026-01-08/factory-094718/ideas/03_visualbell__kids_timer_004",
    "input_stage_paths": [
      "/Users/melted/Documents/GitHub/app factory/the_factory/runs/2026-01-08/factory-094718/ideas/03_visualbell__kids_timer_004/stages/stage02.json",
      "/Users/melted/Documents/GitHub/app factory/the_factory/runs/2026-01-08/factory-094718/ideas/03_visualbell__kids_timer_004/stages/stage02.5.json",
      "/Users/melted/Documents/GitHub/app factory/the_factory/runs/2026-01-08/factory-094718/ideas/03_visualbell__kids_timer_004/stages/stage02.7.json",
      "/Users/melted/Documents/GitHub/app factory/the_factory/runs/2026-01-08/factory-094718/ideas/03_visualbell__kids_timer_004/stages/stage03.json",
      "/Users/melted/Documents/GitHub/app factory/the_factory/runs/2026-01-08/factory-094718/ideas/03_visualbell__kids_timer_004/stages/stage04.json",
      "/Users/melted/Documents/GitHub/app factory/the_factory/runs/2026-01-08/factory-094718/ideas/03_visualbell__kids_timer_004/stages/stage05.json"
    ],
    "boundary_path": "/Users/melted/Documents/GitHub/app factory/the_factory/runs/2026-01-08/factory-094718/ideas/03_visualbell__kids_timer_004"
  },
  "implementation_specifications": {
    "development_priorities": [
      {
        "priority": 1,
        "feature": "Core Timer Functionality",
        "justification": "Essential app functionality that must work perfectly for basic user value",
        "implementation_order": ["Timer state management", "Visual progress display", "Completion alerts", "Basic theme rendering"]
      },
      {
        "priority": 2,
        "feature": "Child-Optimized UI Components",
        "justification": "Critical for target user (children 4-10) successful independent operation",
        "implementation_order": ["Large touch targets", "Visual feedback system", "Error prevention", "Accessibility features"]
      },
      {
        "priority": 3,
        "feature": "Premium Feature Infrastructure",
        "justification": "Required for monetization strategy and business viability",
        "implementation_order": ["RevenueCat integration", "Subscription gating", "Premium theme system", "Paywall implementation"]
      },
      {
        "priority": 4,
        "feature": "Parent Settings and Analytics",
        "justification": "Important for parent value and retention but not core child experience",
        "implementation_order": ["Parent authentication", "Settings interface", "Usage analytics", "Family coordination features"]
      }
    ]
  },
  "component_specifications": {
    "core_ui_components": [
      {
        "component": "CircularTimer",
        "file_path": "src/components/timer/CircularTimer.tsx",
        "purpose": "Main visual timer display with smooth progress animation",
        "props_interface": {
          "duration": "number // seconds",
          "elapsed": "number // seconds elapsed", 
          "theme": "ThemeConfig // visual theme configuration",
          "size": "number // diameter in pixels",
          "onPress": "() => void // pause/resume handler",
          "onComplete": "() => void // completion callback"
        },
        "implementation_requirements": [
          "60fps animation performance using React Native Reanimated",
          "Minimum 280px diameter with responsive scaling for tablets",
          "Smooth gradient color progression (green → yellow → orange)",
          "Theme-specific animation overlay (rocket, fish, flowers, etc.)",
          "Accessibility: VoiceOver compatible with progress announcements",
          "Error handling: Graceful degradation if animation performance poor"
        ],
        "child_specific_optimizations": [
          "Extra-large tap target (entire circle area responsive)",
          "Immediate visual feedback on press (scale animation)",
          "High contrast colors for visibility across room distances",
          "No small interactive elements that require precision"
        ]
      },
      {
        "component": "TimeSelectionButtons",
        "file_path": "src/components/timer/TimeSelectionButtons.tsx", 
        "purpose": "Large, child-friendly duration selection interface",
        "props_interface": {
          "presets": "TimerPreset[] // available time options",
          "onSelect": "(duration: number) => void // selection handler",
          "selectedDuration": "number | null // current selection"
        },
        "implementation_requirements": [
          "Minimum 140px × 100px button size for child motor skills",
          "24px spacing between buttons to prevent accidental taps",
          "Clear visual hierarchy with preset options (5, 10, 15, 30 min)",
          "Custom time slider with large thumb (24px) and haptic feedback",
          "Immediate visual feedback with scaling and color changes",
          "Single tap activation (no confirmation dialogs for basic usage)"
        ],
        "accessibility_features": [
          "VoiceOver labels with duration and description",
          "High contrast mode compatibility",
          "Touch target minimum 44pt iOS / 48dp Android compliance"
        ]
      },
      {
        "component": "ThemeSelector", 
        "file_path": "src/components/themes/ThemeSelector.tsx",
        "purpose": "Visual theme selection with premium feature gating",
        "props_interface": {
          "themes": "Theme[] // available themes",
          "selectedTheme": "string // current theme ID",
          "onThemeSelect": "(themeId: string) => void",
          "premiumUnlocked": "boolean // subscription status"
        },
        "implementation_requirements": [
          "Horizontal scroll layout with 80px × 80px theme previews",
          "3-second theme preview animation on tap",
          "Clear premium lock indicators with parent unlock flow",
          "Smooth transition animations between theme selections",
          "Visual feedback for selected vs available vs locked states"
        ],
        "premium_integration": [
          "Lock overlay for premium themes with clear visual distinction",
          "Parent verification flow for premium unlocks",
          "Graceful fallback to free themes if subscription expires",
          "Preview functionality for locked themes to demonstrate value"
        ]
      },
      {
        "component": "CompletionCelebration",
        "file_path": "src/components/timer/CompletionCelebration.tsx",
        "purpose": "Positive reinforcement when timer completes successfully",
        "props_interface": {
          "theme": "ThemeConfig // completion style matching timer theme",
          "onDismiss": "() => void // celebration completion callback",
          "soundEnabled": "boolean // audio playback permission"
        },
        "implementation_requirements": [
          "Confetti burst animation with 3-second duration",
          "Positive completion message (\"Great job!\", \"Time's up!\", etc.)",
          "Theme-specific celebration elements (space fireworks, underwater bubbles)",
          "Synchronized audio chime (respects device silent mode)",
          "Auto-dismiss after 10 seconds or manual tap",
          "Gentle bounce animation for text elements"
        ],
        "child_psychology_considerations": [
          "Always positive messaging to build confidence",
          "Visual celebrations that reward completion",
          "Non-startling audio cues appropriate for sensitive children",
          "Quick dismissal option if child wants to start next activity"
        ]
      },
      {
        "component": "ParentSettingsModal",
        "file_path": "src/components/parent/ParentSettingsModal.tsx", 
        "purpose": "Adult-optimized configuration interface separate from child UI",
        "props_interface": {
          "visible": "boolean",
          "onClose": "() => void",
          "currentSettings": "ParentSettings",
          "onSettingsChange": "(settings: ParentSettings) => void"
        },
        "implementation_requirements": [
          "PIN or biometric authentication for access",
          "Standard adult touch targets and text sizes", 
          "Timer limit configuration (min/max durations)",
          "Sound management (volume limits, quiet hours)",
          "Theme access control (select free themes available)",
          "Usage analytics dashboard with local data only",
          "Subscription management and family sharing setup"
        ],
        "security_features": [
          "Complete isolation from child interface navigation",
          "Timeout-based automatic closure (5 minutes idle)",
          "No external links or potentially unsafe content",
          "Clear visual distinction from child interface design"
        ]
      }
    ],
    "premium_components": [
      {
        "component": "MultipleTimerManager",
        "file_path": "src/components/premium/MultipleTimerManager.tsx",
        "purpose": "Coordinate up to 3 simultaneous timers for complex family routines",
        "props_interface": {
          "activeTimers": "TimerInstance[]",
          "onAddTimer": "() => void",
          "onRemoveTimer": "(id: string) => void",
          "premiumUnlocked": "boolean"
        },
        "implementation_requirements": [
          "Maximum 3 concurrent timers to prevent confusion",
          "Color-coded timer identification for visual distinction",
          "Stacked layout with clear visual separation",
          "Individual pause/stop controls for each timer",
          "Coordinated completion handling with sequence management"
        ],
        "family_coordination_features": [
          "Different themes per timer for child/activity identification",
          "Offset start times for routine coordination",
          "Completion priority handling (urgent vs normal alerts)",
          "Parent-configurable timer labels and icons"
        ]
      },
      {
        "component": "CustomPresetManager",
        "file_path": "src/components/premium/CustomPresetManager.tsx",
        "purpose": "Parent-configured routine presets for streamlined daily use",
        "props_interface": {
          "presets": "CustomPreset[]",
          "onCreatePreset": "(preset: CustomPreset) => void",
          "onEditPreset": "(id: string, preset: CustomPreset) => void",
          "maxPresets": "number // 3 free, 10 premium"
        },
        "implementation_requirements": [
          "Preset creation wizard with duration, theme, and icon selection",
          "Visual preset icons that children can recognize",
          "Quick access from main timer interface",
          "Usage tracking for most popular presets",
          "Export/import functionality for family device sharing"
        ],
        "preset_examples": [
          "Morning Routine - 15 min with bathroom/getting ready theme",
          "Homework Time - 25 min with focus-supporting visuals",
          "Cleanup Time - 10 min with organizing animations",
          "Quiet Time - 20 min with calming nature theme"
        ]
      },
      {
        "component": "UsageAnalyticsDashboard",
        "file_path": "src/components/premium/UsageAnalyticsDashboard.tsx",
        "purpose": "Local analytics for parent insights into routine effectiveness",
        "props_interface": {
          "analyticsData": "AnalyticsData",
          "dateRange": "DateRange",
          "onDateRangeChange": "(range: DateRange) => void"
        },
        "implementation_requirements": [
          "Weekly/monthly usage pattern visualization",
          "Timer completion rate tracking and trends",
          "Most popular themes and duration analysis",
          "Routine consistency scoring with improvement suggestions",
          "Export functionality for external routine planning"
        ],
        "privacy_compliance": [
          "All data stored locally on device only",
          "No external analytics services or data transmission",
          "Clear data retention policies with parent control",
          "Option to clear analytics data while preserving app functionality"
        ]
      }
    ]
  },
  "technical_implementation_specs": {
    "timer_accuracy_implementation": {
      "primary_timer": {
        "technology": "JavaScript setInterval with 100ms precision",
        "accuracy_correction": "Track actual elapsed time vs expected progress",
        "drift_handling": "Adjust remaining time based on real clock time every 5 seconds",
        "background_persistence": "Store timer state and start timestamp in AsyncStorage"
      },
      "notification_backup": {
        "technology": "expo-notifications for background completion alerts", 
        "scheduling": "Schedule local notification when timer starts",
        "cancellation": "Cancel notification when app returns to foreground or timer stops",
        "accuracy": "System notification timing ±1 second acceptable for completion alerts"
      },
      "state_synchronization": {
        "foreground_restore": "Calculate elapsed time from stored timestamp on app foreground",
        "accuracy_validation": "Compare JavaScript timer progress with actual elapsed time",
        "correction_threshold": "Adjust timer if >500ms drift detected",
        "user_feedback": "Visual indication if timer was corrected due to background timing"
      }
    },
    "animation_system_implementation": {
      "progress_animation": {
        "library": "React Native Reanimated 3.x for native performance",
        "update_frequency": "60fps progress updates using requestAnimationFrame",
        "color_interpolation": "Smooth gradient transitions (green → yellow → orange)",
        "theme_overlay": "SVG-based theme animations synchronized with progress"
      },
      "theme_animations": {
        "space_adventure": "Rocket ship travels along circular path with particle trail",
        "underwater_world": "Fish swims through coral with bubbles following progress",
        "fairy_garden": "Flowers bloom around circle perimeter as time progresses",
        "construction_zone": "Building construction advances with timer completion"
      },
      "performance_optimization": {
        "native_driver": "Use native animation driver where possible",
        "memory_management": "Dispose animation objects on completion",
        "fallback_strategy": "Reduce animation complexity on low-performance devices",
        "frame_rate_monitoring": "Track animation FPS and degrade gracefully"
      }
    },
    "subscription_integration_implementation": {
      "revenuecat_setup": {
        "initialization": "Configure RevenueCat SDK on app launch with environment-specific keys",
        "user_identification": "Anonymous users with stable device-generated identifier",
        "offerings_fetch": "Load subscription offerings on app start with offline caching"
      },
      "entitlement_checking": {
        "feature_gates": "Check entitlements before allowing premium features",
        "caching_strategy": "Cache entitlement status for offline access",
        "refresh_triggers": "Refresh entitlements on app foreground and purchase completion",
        "graceful_degradation": "Maintain app functionality if RevenueCat unavailable"
      },
      "purchase_flow": {
        "paywall_triggers": "Show paywall on premium feature access attempts",
        "purchase_completion": "Immediately unlock features on successful purchase",
        "error_handling": "Clear error messages for purchase failures",
        "restoration": "Restore purchases functionality for device transfers"
      }
    }
  },
  "data_persistence_implementation": {
    "sqlite_database_setup": {
      "initialization": "Create database and tables on first app launch",
      "migration_system": "Version-controlled schema migrations for app updates",
      "performance_optimization": "Appropriate indexes for query patterns",
      "data_integrity": "Foreign key constraints and data validation"
    },
    "repository_pattern": {
      "timer_sessions_repository": "CRUD operations for timer usage tracking",
      "custom_presets_repository": "Preset management with premium tier enforcement",
      "themes_repository": "Theme metadata and usage statistics",
      "analytics_repository": "Local analytics aggregation and reporting"
    },
    "async_storage_usage": {
      "user_preferences": "Sound settings, parent PIN, UI preferences",
      "app_state": "Last used theme, recent presets, session restoration data",
      "subscription_cache": "Offline entitlement status for premium features",
      "performance_settings": "Animation quality level, reduced motion preferences"
    }
  },
  "child_safety_implementation": {
    "interface_isolation": {
      "navigation_restrictions": "No deep linking or external navigation from child interface",
      "content_filtering": "All content child-safe with no external references",
      "interaction_boundaries": "Clear separation between child and parent interfaces"
    },
    "data_protection": {
      "minimal_collection": "No personal information collected from child interactions",
      "local_storage": "All child usage data stored locally only",
      "parent_control": "Parent access required for any data sharing or account features"
    },
    "coppa_compliance": {
      "age_verification": "No age collection or child identity verification required",
      "data_practices": "COPPA-compliant data handling with minimal collection",
      "parental_controls": "Parent oversight for all app configuration and premium features"
    }
  },
  "performance_requirements": {
    "startup_performance": {
      "cold_start_target": "Sub-3 second app launch to ready state",
      "warm_start_target": "Sub-1 second app restoration",
      "optimization_strategies": "Bundle splitting, lazy loading, critical path optimization"
    },
    "runtime_performance": {
      "animation_target": "Consistent 60fps for timer progress animations",
      "memory_usage": "Under 50MB RAM for core functionality",
      "battery_optimization": "Minimal background processing, efficient timer implementation"
    },
    "responsiveness_targets": {
      "touch_response": "Sub-100ms visual feedback for all interactive elements",
      "timer_start": "Sub-200ms from tap to timer start",
      "screen_transitions": "Sub-300ms smooth navigation between screens"
    }
  },
  "testing_specifications": {
    "unit_testing_priorities": [
      "Timer accuracy and state management logic",
      "Subscription entitlement checking and caching",
      "Database operations and data persistence",
      "Animation performance and error handling"
    ],
    "integration_testing_requirements": [
      "Complete timer lifecycle (start, pause, resume, complete)",
      "Premium feature access with subscription gating",
      "Background/foreground timer state synchronization",
      "Parent settings and child interface isolation"
    ],
    "child_usability_testing": [
      "Children age 4-6 can start timer independently within 30 seconds",
      "Children age 7-10 understand timer progress visually",
      "Error recovery testing with common child interaction patterns",
      "Accessibility testing with VoiceOver and reduced motion"
    ],
    "parent_acceptance_testing": [
      "Parent can configure app for family needs within 5 minutes",
      "Subscription purchase flow is clear and trustworthy",
      "Usage analytics provide actionable insights",
      "Family coordination features work reliably across devices"
    ]
  },
  "deployment_readiness_checklist": [
    {
      "category": "Core Functionality",
      "requirements": [
        "Timer accuracy within ±100ms for all durations",
        "Smooth 60fps animations on target devices",
        "Background/foreground state synchronization working", 
        "Audio completion alerts respecting device settings"
      ]
    },
    {
      "category": "Child Experience",
      "requirements": [
        "All touch targets meet 64px minimum size requirement",
        "Visual feedback immediate (sub-100ms) for all interactions",
        "Error states handled gracefully with child-friendly messaging",
        "Accessibility features working for vision and motor impairments"
      ]
    },
    {
      "category": "Premium Features",
      "requirements": [
        "RevenueCat integration working in sandbox and production",
        "All premium features properly gated with entitlement checking",
        "Subscription purchase and restoration flow tested",
        "Family sharing working across multiple devices"
      ]
    },
    {
      "category": "Parent Value",
      "requirements": [
        "Parent settings interface complete and secure",
        "Usage analytics accurate and helpful",
        "Custom presets creation and management working",
        "Multi-device synchronization reliable"
      ]
    },
    {
      "category": "Safety & Compliance",
      "requirements": [
        "No external navigation from child interface",
        "COPPA-compliant data handling verified",
        "All analytics data stored locally only",
        "Parent authentication protecting sensitive features"
      ]
    }
  ]
}