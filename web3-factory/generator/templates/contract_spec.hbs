# Contract Specification: {{app_name}}

This document defines how the app integrates with Solana blockchain.

---

## Overview

**App:** {{app_name}}
**Idea:** {{idea}}
**Generated:** {{timestamp}}

---

## Token Integration

### Token Configuration

The app uses a custom SPL token created via factoryapp.dev at launch time.

```typescript
// Token address (set after launch)
TOKEN_MINT: PublicKey (from env: NEXT_PUBLIC_TOKEN_MINT)

// Standard SPL token configuration
DECIMALS: 9
```

---

## Wallet Integration

### Supported Wallets

| Wallet | Status | Notes |
|--------|--------|-------|
| Phantom | Required | Most popular |
| Solflare | Required | Web + mobile |
| Others | Disabled | Avoid compatibility issues |

### Connection Flow

```
1. User clicks "Connect Wallet"
2. Wallet modal appears
3. User selects wallet (Phantom/Solflare)
4. Wallet prompts for approval
5. Connection established
6. App fetches token balance
```

---

## Read Operations (Free)

These operations read from the blockchain without cost:

| Operation | Description |
|-----------|-------------|
| Get token balance | Read user's token balance |
| Get token metadata | Name, symbol, decimals |
| Get account info | Wallet SOL balance |

---

## Write Operations (Require Signature)

These operations require user signature and may cost SOL:

| Operation | Cost | Description |
|-----------|------|-------------|
| Token transfer | ~0.000005 SOL | Send tokens to another wallet |
| ATA creation | ~0.002 SOL | First-time token receive |

**Important:** The app NEVER requests private keys. All signatures happen in the user's wallet.

---

## Mock Data Pattern

For features that require backend infrastructure, use this pattern:

```typescript
// Feature that would need backend
const [data, setData] = useState<FeatureData | null>(null);
const [loading, setLoading] = useState(true);

useEffect(() => {
  // In production, this would call your API
  // For now, use mock data
  const mockData = generateMockData();
  setData(mockData);
  setLoading(false);
}, []);
```

Document what needs real backend in README.md.

---

## Security Requirements

### Never Do

- Request private keys
- Store signatures
- Execute transactions without user approval
- Hardcode sensitive data
- Make API calls with secrets in frontend

### Always Do

- Use environment variables for configuration
- Validate all inputs
- Show transaction details before signing
- Handle errors gracefully
- Use HTTPS in production

---

## Environment Variables

```bash
# Required
NEXT_PUBLIC_SOLANA_RPC_URL=https://api.mainnet-beta.solana.com
NEXT_PUBLIC_SOLANA_NETWORK=mainnet-beta
NEXT_PUBLIC_TOKEN_MINT=<set_after_launch>

# Optional
NEXT_PUBLIC_API_URL=https://api.yourapp.com
```

---

## Error Handling

### Wallet Errors

```typescript
try {
  await wallet.connect();
} catch (error) {
  if (error.name === "WalletNotReadyError") {
    // Wallet not installed
    showMessage("Please install Phantom or Solflare wallet");
  } else if (error.name === "WalletConnectionError") {
    // User rejected
    showMessage("Connection cancelled");
  } else {
    // Other error
    showMessage("Failed to connect wallet");
  }
}
```

### Transaction Errors

```typescript
try {
  const signature = await sendTransaction(transaction, connection);
  await connection.confirmTransaction(signature);
} catch (error) {
  if (error.message.includes("User rejected")) {
    showMessage("Transaction cancelled");
  } else if (error.message.includes("insufficient")) {
    showMessage("Insufficient balance");
  } else {
    showMessage("Transaction failed");
  }
}
```

---

## After Launch

Once your token is created on factoryapp.dev:

1. Update `NEXT_PUBLIC_TOKEN_MINT` with real address
2. Token balance will display correctly
3. Transfer features will work

---

**This spec ensures consistent blockchain integration across all Web3 Factory apps.**
